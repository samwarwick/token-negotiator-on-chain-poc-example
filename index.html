<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="initial-scale=1, maximum-scale=1">
   <title>Vanilla Store</title>
   <meta name="keywords" content="">
   <meta name="description" content="">
   <meta name="author" content="">

   <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js"
      integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
      crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js"
      integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
      crossorigin="anonymous"></script>
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/css/bootstrap.min.css"
      integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

   <link rel="stylesheet" href="./css/style.css">
   <!-- TN + Authenticator -->
   <script type="text/javascript" src="./dist/negotiator.js"></script>
   <script type="text/javascript" src="./authenticator.js"></script>
</head>

<body>

   <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 20px;">
      <div class="toast" data-delay="4000" style="position: fixed; top: 23px; right: 80px; z-index: 100; background: #7ec98b;">
         <div class="toast-header">
            <strong class="mr-auto">Exclusive offers</strong>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
               <span aria-hidden="true">&times;</span>
            </button>
         </div>
         <div class="toast-body"></div>
      </div>
   </div>

   <div class="container">

      <div class="row" style="padding: 20px">
         <div class="col">
            <ul class="nav" id="main-menu-nav">
               <li class="nav-item">
                  <a class="nav-link active" href="#">Welcome</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link disabled" href="#">Shop</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Checkout</a>
               </li>
            </ul>
         </div>
         <div class="col">
            <svg id="profile"
               style="background-image: url(./images/banner-bg.png); background-size: cover; background-position: center;"
               class="float-right bd-placeholder-img rounded-circle" width="75" height="75"
               xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"
               aria-label="Completely round image: 75x75">
            </svg>
         </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
         <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">BAYC/MAYC VIP Party:</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                     <span aria-hidden="true">&times;</span>
                  </button>
               </div>
               <div class="modal-body">
                  <p>
                     Click here to claim your ticket attestation. You will need to provide a Twitter handle
                     to recieve details of the location 2 hours before the event in NYC!
                  </p>
                  <p>
                     19:00pm-06:30am
                  </p>
                  <p>
                     (Bring a friend, each ticket permits a +1)
                  </p>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Claim</button>
               </div>
            </div>
         </div>
      </div>

      <div class="jumbotron">
         <h1 class="display-4">Hello, world!</h1>
         <p class="lead">This is the place to find great deals for; car hire, hotels, event tickets and more.</p>
         <hr class="my-4">
         <p>It uses utility classes for typography and spacing to space content out within the larger container.</p>
         <a class="btn btn-primary btn-lg" id="news-letter-subscription" href="#" role="button">Subscribe</a>
      </div>

      <div class="card text-center" id="vogue-sub-offer" style="display: none; margin: 32px 0;">
         <div class="card-header">
            Featured
         </div>
         <div class="card-body">
            <h5 class="card-title">10% Off Vogue Magazine Subscription</h5>
            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
            <a href="" class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Claim</a>
         </div>
         <div class="card-footer text-muted">Available for 2 more days - exclusive to BAYC Derivative + Women Tribe
            holders</div>
      </div>

      <div class="card text-center" id="vip-offer" style="display: none; margin: 32px 0;">
         <div class="card-header">
            Featured
         </div>
         <div class="card-body">
            <h5 class="card-title">20% Off for your next VIP experience</h5>
            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
            <p class="card-text">CODE: XYZ15</p>
            <a href="" class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Claim</a>
         </div>
         <div class="card-footer text-muted">Available for exclusive to BAYC Derivative holders</div>
      </div>

      <div class="row">
         <div class="col">
            <h2 style="margin: 50px 0 30px 0" class="text-center">Fashion, Music & Events:</h2>
         </div>
      </div>

      <div class="row">
         <div class="col" id="clothing-offers" style="display: flex; justify-content: center;">
            <div class="card" style="width: 18rem; margin: 20px;">
               <img src="./images/dress-shirt-img.png" class="card-img-top" style="padding: 20px" alt="">
               <div class="card-body">
                  <h5 class="card-title">Card title</h5>
                  <p class="card-text">Some quick example text to build on the card title and make up the bulk of the
                     card's content.</p>
                  <a href="#" class="btn btn-primary">Buy</a>
               </div>
            </div>
         </div>
      </div>

      <div class="row">
         <div class="col">
            <h2 style="margin: 50px 0 30px 0" class="text-center">Buy, hire & Test Drive:</h2>
         </div>
      </div>

      <div class="row">
         <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" style="width:100%">
            <ol class="carousel-indicators">
               <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"
                  style="filter: invert(100%);"></li>
               <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
               <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
               <div class="carousel-item active" id="car-hire-carousel">
                  <img src="./images/1-1.png" class="d-block w-100">
                  <div class="carousel-caption d-none d-md-block">
                     <h5
                        style="width: 250px; background: rgba(0,0,0,0.5); padding: 0; margin: 0; border-top-right-radius: 20px;">
                        Test Drive:</h5>
                     <p style="width: 250px; background: rgba(0,0,0,0.5); padding: 0; margin: 0;">Test Drive The New C5
                        AirCross
                     </p>
                     <p id="test-drive-book-offer-no"
                        style="width: 250px; background: rgba(0,0,0,0.5); padding: 0; margin: 0;">Coming Soon</p>
                     <a id="test-drive-book-offer" href="" style="display: none; width: 130px; margin: 20px 0;"
                        class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Book Today</a>
                  </div>
               </div>
               <div class="carousel-item" id="car-hire-offer"><img src="./images/3.png" class="d-block w-100">
                  <div class="carousel-caption d-none d-md-block">
                     <img src="./images/riot-racers.png"
                        style="position: relative; width: 100px; left: 40%; top: 40px;">
                     <h5 id="car-hire-offer-available-price"
                        style="display: none; width: 200px; background: rgba(0,0,0,0.5); padding: 0; margin: 0; border-top-right-radius: 20px;">
                        Hire: $310 p/w</h5>
                     <h5 id="car-hire-offer-not-available-price"
                        style="width: 200px; background: rgba(0,0,0,0.5); padding: 0; margin: 0; border-top-right-radius: 20px;">
                        Hire: $tbc</h5>
                     <p id="car-hire-coming-soon"
                        style="width: 200px; background: rgba(0,0,0,0.5); padding: 0; margin: 0;">Coming Soon</p>
                     <a id="car-hire-offer-available" href="" style="display: none; width: 130px; margin: 20px 0;"
                        class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Hire Today</a>
                  </div>
               </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
               <span style="filter: invert(100%);" class="carousel-control-prev-icon" aria-hidden="true"></span>
               <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
               <span style="filter: invert(100%);" class="carousel-control-next-icon" aria-hidden="true"></span>
               <span class="sr-only">Next</span>
            </a>
         </div>
      </div>

   </div>

   <div class="container">

      <!-- Footer -->
      <footer class="page-footer font-small blue"
         style="background: #3a3a3a; margin-top: 40px; padding: 20px; width: 98%;">

         <!-- Footer Links -->
         <div class="container-fluid text-center text-md-left">

            <!-- Grid row -->
            <div class="row">

               <!-- Grid column -->
               <div class="col-md-6 mt-md-0 mt-3">

                  <!-- Content -->
                  <h5 class="text-uppercase" style="color: grey;">Our Store</h5>
                  <p></p>

               </div>
               <!-- Grid column -->

               <hr class="clearfix w-100 d-md-none pb-3">

               <!-- Grid column -->
               <div class="col-md-3 mb-md-0 mb-3">

                  <!-- Links -->
                  <h5 style="color: grey">Pages</h5>

                  <ul class="list-unstyled">
                     <li>
                        <a href="#!">Shop</a>
                     </li>
                     <li>
                        <a href="#!">Offers</a>
                     </li>
                  </ul>

               </div>
               <!-- Grid column -->

               <!-- Grid column -->
               <div class="col-md-3 mb-md-0 mb-3">

                  <!-- Links -->
                  <h5 style="color: grey">Contact Us</h5>

                  <ul class="list-unstyled">
                     <li>
                        <a href="#!">Support</a>
                     </li>
                  </ul>

               </div>

            </div>

         </div>

      </footer>

      <div class="overlay-tn"></div>

   </div>

   <script>

      function openNav() {
         document.getElementById("mySidenav").style.width = "250px";
      }

      function closeNav() {
         document.getElementById("mySidenav").style.width = "0";
      }

      /*
      var negotiator = new negotiator.Client({
         type: 'active',
         issuers: [
            { contract: '0x88b48f654c30e99bc2e4a1559b4dcf1ad93fa656', chain: 'rinkeby', ref: "rinkeyby punks", openSeaSlug: 'rinkeby-punk' },
            { contract: '0x88b48f654c30e99bc2e4a1559b4dcf1ad93fa656', chain: 'rinkeby', ref: "stl rnd women tribe", openSeaSlug: 'stl-rnd-women-tribe-nfts' },
            { contract: '0x88b48f654c30e99bc2e4a1559b4dcf1ad93fa656', chain: 'rinkeby', ref: "stl rnd zed run", openSeaSlug: 'stl-rnd-zed' },
            { contract: '0x88b48f654c30e99bc2e4a1559b4dcf1ad93fa656', chain: 'rinkeby', ref: "stl rnd bayc derivatives", openSeaSlug: 'stl-rnd-bayc-derivatives' },
            { contract: '0x88b48f654c30e99bc2e4a1559b4dcf1ad93fa656', chain: 'rinkeby', ref: "stl riot racers", openSeaSlug: 'stl-rnd-riot-racers' }
         ],
         options: {
            overlay: {
               openingHeading: "Open a new world of discounts available with your tokens.",
               issuerHeading: "Get discount with Ticket",
               repeatAction: "try again",
               theme: "light",
               position: "bottom-right"
            },
            filters: {},
         }
      });
      */
      var negotiator = new negotiator.Client({
         type: 'active',
         issuers: [
            { contract: '0x09e09a5e171ea4e97d87e489c91af1897043821a', chain: 'rinkeby', ref: "Sleepy Koalas", openSeaSlug: 'sleepykoala-xxiehahwgb' },
            { contract: '0xECBc217b13dEA841c33b5b68c9c98041C2136205', chain: 'rinkeby', ref: "Castles", openSeaSlug: 'mynft-pjb9cuz8wv' },
         ],
         options: {
            overlay: {
               openingHeading: "Open a new world of discounts available with your tokens.",
               issuerHeading: "Get discount with Ticket",
               repeatAction: "try again",
               theme: "light",
               position: "bottom-right"
            },
            filters: {},
         }
      });

      // Exmaple of customer offers.
      // A - Tickets to Studio54 offered to BAYC Derivative Holders
      // B - Free T-shirt for Expansion Punk Holders Or Zed Holders
      // C - BAYC + Woman tribe allows for a subscription to Vogue
      // D - Car Hire Discount
      // E - Car Hire Demo 
      // F - VIP

      var offers = {
         offerA: {
            notificationText: "Studio54 tickets available",
            validation: (tokensLength) => {
               if (tokensLength > 0 && !document.getElementById('studio-ticket-offer')) {
                  document.getElementById('main-menu-nav').innerHTML += `<li class="nav-item" id="studio-ticket-offer"><button type="button" class="btn btn-primary special-offer fade-in top-down-anim" data-toggle="modal" data-target="#exampleModal" onclick="claimDiscountMockEvt(event)">Free Tickets: Studio 57</button></li>`;
                  showToast(offers.offerA.notificationText);
               }
               if (tokensLength === 0 && document.getElementById('studio-ticket-offer')) {
                  document.getElementById('studio-ticket-offer').remove();
               }
            }
         },
         offerB:
         {
            notificationText: "Fashion: Claim a free T-shirt",
            validation: (tokensLength) => {
               if (tokensLength > 0 && !document.getElementById('punks-tshirt-offer')) {
                  document.getElementById('clothing-offers').innerHTML += `<div id="punks-tshirt-offer" class="card" style="width: 18rem; margin: 20px;"><img src="./images/tee.jpeg" class="card-img-top" style="padding: 20px" alt=""><div class="card-body"><h5 class="card-title">Card title</h5><p class="card-text">Some quick example text to build on the card title and make up the bulk of thecard's content.</p><a href="#" class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Free T-shirt</a></div></div>`;
                  showToast(offers.offerB.notificationText);
               }
               if (tokensLength === 0 && document.getElementById('punks-tshirt-offer')) {
                  document.getElementById('punks-tshirt-offer').remove();
               }
            }
         },
         offerC: {
            notificationText: "10% Off Vogue Magazine Subscription",
            validation: (bayc, wt) => {
               if (bayc > 0 && wt > 0) {
                  document.getElementById('vogue-sub-offer').style.display = 'block';
                  showToast(offers.offerC.notificationText);
               }
               if (bayc === 0 || wt === 0) {
                  document.getElementById('vogue-sub-offer').style.display = 'none';
               }
            }
         },
         offerD: {
            notificationText: "Car Hire Available",
            validation: (tokensLength) => {
               if (tokensLength > 0) {
                  document.getElementById('car-hire-coming-soon').style.display = 'none';
                  document.getElementById('car-hire-offer-not-available-price').style.display = 'none';
                  document.getElementById('car-hire-offer-available').style.display = 'block';
                  document.getElementById('car-hire-offer-available-price').style.display = 'block';
                  showToast(offers.offerD.notificationText);
               }
               if (tokensLength === 0) {
                  document.getElementById('car-hire-coming-soon').style.display = 'block';
                  document.getElementById('car-hire-offer-not-available-price').style.display = 'block';
                  document.getElementById('car-hire-offer-available').style.display = 'none';
                  document.getElementById('car-hire-offer-available-price').style.display = 'none';
               }
            }
         },
         offerE: {
            notificationText: "Test Drive Available",
            validation: (tokensLength) => {
               if (tokensLength > 0) {
                  document.getElementById('test-drive-book-offer-no').style.display = 'none';
                  document.getElementById('test-drive-book-offer').style.display = 'block';
                  showToast(offers.offerE.notificationText);
               }
               if (tokensLength === 0) {
                  document.getElementById('test-drive-book-offer-no').style.display = 'block';
                  document.getElementById('test-drive-book-offer').style.display = 'none';
               }
            }
         },
         offerF: {
            notificationText: "20% off your next VIP experience",
            validation: (tokensLength) => {
               if (tokensLength > 0) {
                  document.getElementById('vip-offer').style.display = 'block';
                  showToast(offers.offerF.notificationText);
               }
               if (tokensLength === 0) {
                  document.getElementById('vip-offer').style.display = 'none';
               }
            }
         },
         offerG: {
            notificationText: "Fashion: Claim a free T-shirt",
            validation: (tokensLength) => {
               if (tokensLength > 0 && !document.getElementById('zed-tshirt-offer')) {
                  document.getElementById('clothing-offers').innerHTML += `<div id="zed-tshirt-offer" class="card" style="width: 18rem; margin: 20px;"><img src="./images/zed.jpg" class="card-img-top" style="padding: 20px" alt=""><div class="card-body"><h5 class="card-title">Card title</h5><p class="card-text">Some quick example text to build on the card title and make up the bulk of thecard's content.</p><a href="#" class="btn btn-primary" onclick="claimDiscountMockEvt(event)">Free T-shirt</a></div></div>`;
                  showToast(offers.offerG.notificationText);
               }
               if (tokensLength === 0 && document.getElementById('zed-tshirt-offer')) {
                  document.getElementById('zed-tshirt-offer').remove();
               }
            }
         }
      };

      var bayc = 0;
      var wt = 0;

      negotiator.on("tokens-selected", (tokens) => {

         const { selectedTokens } = tokens;

         for (var key in selectedTokens) {

            if (key.includes('stl-rnd-bayc-derivatives')) {

               bayc = selectedTokens[key].tokens.length;
               offers.offerA.validation(bayc);
               offers.offerC.validation(bayc, wt);
               offers.offerF.validation(bayc);

            }

            if (key.includes('rinkeby-punk')) {

               punks = selectedTokens[key].tokens.length;
               offers.offerB.validation(punks);

            }

            if (key.includes('stl-rnd-zed')) {

               offers.offerG.validation(selectedTokens[key].tokens.length);

            }

            if (key.includes('stl-rnd-women-tribe-nfts')) {

               wt = selectedTokens[key].tokens.length;
               offers.offerC.validation(bayc, wt);

            }

            if (key.includes('stl-rnd-riot-racers')) {

               wt = selectedTokens[key].tokens.length;
               offers.offerD.validation(selectedTokens[key].tokens.length);

            }

            if (key.includes('stl-rnd-riot-racers')) {

               wt = selectedTokens[key].tokens.length;
               offers.offerE.validation(selectedTokens[key].tokens.length);

            }

            if (key.includes('sleepykoala-xxiehahwgb')) {
               bayc = selectedTokens[key].tokens.length;
               offers.offerA.validation(bayc);
               offers.offerC.validation(bayc, wt);
               offers.offerF.validation(bayc);
            }

            if (key.includes('mynft-pjb9cuz8wv')) {
               punks = selectedTokens[key].tokens.length;
               offers.offerB.validation(punks);
            }

         }

      });

      negotiator.on("token-proof", (proof) => {
         console.log(proof);
      });

      negotiator.negotiate();

      function claimDiscountMockEvt(event) {
         event.preventDefault();
         event.target.classList.add("btn-success");
      }

      function showToast(offer) {
         $('.toast').toast('show');
         $('.toast-body').html(offer);
      }

   </script>
</body>

</html>